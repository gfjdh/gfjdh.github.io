<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>清水乡</title>
  
  <subtitle>你从哪里来，又要到哪里去</subtitle>
  <link href="http://gfjdh.cn/atom.xml" rel="self"/>
  
  <link href="http://gfjdh.cn/"/>
  <updated>2024-08-12T16:01:48.971Z</updated>
  <id>http://gfjdh.cn/</id>
  
  <author>
    <name>清水尚辉</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>觉bot开发日记</title>
    <link href="http://gfjdh.cn/2024/08/12/%E8%A7%89bot%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/"/>
    <id>http://gfjdh.cn/2024/08/12/%E8%A7%89bot%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/</id>
    <published>2024-08-11T19:02:33.425Z</published>
    <updated>2024-08-12T16:01:48.971Z</updated>
    
    <content type="html"><![CDATA[<p>三个插件共同构成的，带有一定货币属性的功能体系<br><a href="https://github.com/gfjdh/koishi-plugin-p-qiandao">签到：p-qiandao</a><br><a href="https://github.com/gfjdh/koishi-plugin-p-setu">涩图：p-setu</a><br><a href="https://github.com/gfjdh/koishi-plugin-p-graze">擦弹：p-graze</a></p><p>以下是个人从零开始搭建bot到开始自己开发插件的感想和碎碎念</p><h2 id="2023年10月1日，国庆节。"><a href="#2023年10月1日，国庆节。" class="headerlink" title="2023年10月1日，国庆节。"></a>2023年10月1日，国庆节。</h2><p>国庆假期第一天，在宿舍里百无聊赖的我心血来潮，上网搜索了qq机器人搭建，并且进入了koishi论坛，论坛里详细的教程和blocky的零代码开发功能让我眼前一亮。<br>当时还没有官方的开放平台，我跟着liharp佬的教程一步一步完成了bot的搭建，虽然中间遇到了多次问题，但是都被一一解决，直到当天晚上，koishi的右下角亮起了绿灯。<br>作为一个觉厨，我以古明地觉为原型制作的：觉bot，诞生了。<br>我兴奋地用blocky创建了一些简单的插件，关键词对话之类的。</p><p>第二天，我再次来到论坛搜索，在blocky板块寻找我感兴趣的插件。<br><a href="https://forum.koishi.xyz/t/topic/626">最终选中了这个插件</a><br>签到成为了觉bot的第一个功能。到现在，虽然这个插件经过了我无数次的改造，但是仍然可以看到最初版的影子，并且觉bot的绝大部分功能都是围绕p点-签到体系构建的。近期，我将它改编成了正常的插件并且发布了。<a href="https://github.com/gfjdh/koishi-plugin-p-qiandao">签到插件储存库</a></p><p>作为一个lsp，以及出于“我需要一个吸引人的功能”考虑，我又找了一个blocky编写的<a href="https://forum.koishi.xyz/t/topic/5015">涩图插件</a>，这成为了觉的第二个核心功能，同样的，现在它已经是正常的插件并且发布在了插件市场。<a href="https://github.com/gfjdh/koishi-plugin-p-setu">涩图插件储存库</a> <del>lolicon这个图库api真不知道造福多少bot）</del></p><p>在本人<del>臭不要脸</del>的推广下，也是有了上百人的用户量，在群u的建议下自己用blocky编写了第三个核心功能：<a href="https://github.com/gfjdh/koishi-plugin-p-graze">擦弹</a> 其实就是换皮的轮盘赌，被打中的人会爆p点到群奖池，其他人擦弹可以从群奖池里获取p点<del>暗中克扣一部分还可以减少通胀</del>。</p><p>逐渐的，感觉用blocky编写插件有些力不从心了，很多想实现的功能受限制，数据库里的屎山更是看着都头大，于是萌生了学习代码编写插件的想法。<br>本人之前<strong>完全没接触过</strong>typeScript和JavaScript，纯跟随koishi文档创建模板项目，然后把blocky编译出来的代码粘贴过来一点一点硬啃，不懂的就查koishi的官方文档或者问ai，最终在这个暑假完成了对全部blocky插件的重构。<br>并且为从blocky数据库迁移用户数据到新数据库专门写了两个新插件<a href="https://github.com/gfjdh/koishi-plugin-p-bat">这是其中一个</a>，如果有类似需求的朋友可以联系我使用<del>（真有人用吗？）</del></p><p>后来，涩图插件发的图总是频繁的被吞，深受群u抱怨。其实tx吞图的原理很简单，它只是检测到这一张图应该屏蔽，而实际上不看图的内容。所以我用puppeteer给获取到的图片渲染了1px的白边框，从此以后再也没有被吞过图。<del>我觉得这个操作应该是我首创的</del></p><p>直到现在，觉身上的功能已经基本完善，发布的插件也都得到了接近甚至满分的评价，我才决定把我写的插件在这里发布出来，虽然我也知道我写的基本是屎山，但是我个人感觉功能还是不错的。</p><h2 id="现在在做什么"><a href="#现在在做什么" class="headerlink" title="现在在做什么"></a>现在在做什么</h2><p>一是继续完善以p点为核心的功能。<br>二是正在尝试接入ai。<br>我一直觉得bot的灵魂就是要像一个<strong>有情感的生命</strong>，她们存在的意义就是带来情绪价值，自己手动写的提示语再有个性，终究也是死的，但是有ai就不一样了。</p><ul><li>为什么不用OpenAi：gpt固然好，但是门槛真是高，用官方接口的话注册账号是问题，用第三方接口的话价格又不便宜，简单的对话没必要要求那么高，所以我选择国产模型。</li></ul><p>接口大部分是要收费的，但是我偶然间找到了一个可以免费使用一个月的接口，并且看上去性能还不错，于是着手开发接入它的插件。<br>说是开发，其实是魔改其他人的插件，<del>惨遭我毒手的是</del> <a href="https://github.com/initialencounter/2022-12-24/tree/neat/plugins/AI/davinci-003#readme">davinci-003</a>插件，目前经过我的改造已经可以使用了，但是我不确定这种插件能不能发布在插件市场，而且还有很多bug和设想的功能没搞完。</p><h2 id="未来的计划？"><a href="#未来的计划？" class="headerlink" title="未来的计划？"></a>未来的计划？</h2><p>1.我想让觉有长期记忆。<br>具体实现思路基本是天马行空，而且以我的码力遥不可及<br>2.自我保护功能<br>比如检测到屏蔽词拉黑，被禁言退群之类的，目前没有针对我使用的接入方式的相关插件<del>可能是不支持？</del>。</p><h2 id="最后来一些自己总结的小教训"><a href="#最后来一些自己总结的小教训" class="headerlink" title="最后来一些自己总结的小教训"></a>最后来一些自己总结的小教训</h2><p><strong>实例爆炸了如何抢救？</strong>：勤备份比什么都强，但是如果已经无法挽回，在双清之前把data文件夹里的koishi.db抢救出来是个好选择，至少可以保住数据库里的数据，插件什么的重新安装就好。<br><strong>如何在本地安装自己编写的插件？</strong>：按标准格式命名文件夹然后把lib文件夹，package.json和readme丢进去，再把这个文件夹放进node_modules，最后重启实例，在插件全局设置左上角添加插件即可。但是注意，这么做属于不安全行为，请考虑清楚后果再操作。</p><p>暂时先这些，以后这个帖子可能长期更新</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;三个插件共同构成的，带有一定货币属性的功能体系&lt;br&gt;&lt;a href=&quot;https://github.com/gfjdh/koishi-plugin-p-qiandao&quot;&gt;签到：p-qiandao&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/gfj</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://gfjdh.cn/2024/08/04/hello-world/"/>
    <id>http://gfjdh.cn/2024/08/04/hello-world/</id>
    <published>2024-08-04T12:21:08.761Z</published>
    <updated>2024-08-12T16:01:52.882Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot;&gt;documentation&lt;/a&gt; for</summary>
      
    
    
    
    
  </entry>
  
</feed>
